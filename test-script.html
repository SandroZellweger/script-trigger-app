<!DOCTYPE html>
<html>
<head>
    <title>Google Apps Script Test</title>
</head>
<body>
    <h1>Google Apps Script Test</h1>
    <button onclick="testPing()">Test Ping</button>
    <button onclick="testCalendar()">Test Calendar</button>
    <button onclick="testStripe()">Test Stripe</button>
    <div id="output"></div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxksJAHHqDZ7E2VTp3TazcC4SOCOWef2oM2Tz5MY5Px--A7TUqNjIXeUev5J1QW-T0b/exec';
        const AUTH_TOKEN = 'myAppToken2025';

        function log(message) {
            const output = document.getElementById('output');
            output.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${message}</div>`;
        }

        async function testPing() {
            log('Testing ping...');
            try {
                const url = `${SCRIPT_URL}?function=ping&authToken=${AUTH_TOKEN}`;
                log(`URL: ${url}`);
                
                const response = await fetch(url);
                log(`Response status: ${response.status}`);
                log(`Response ok: ${response.ok}`);
                
                const data = await response.text();
                log(`Response text: ${data}`);
                
                try {
                    const jsonData = JSON.parse(data);
                    log(`Parsed JSON: ${JSON.stringify(jsonData, null, 2)}`);
                } catch (e) {
                    log(`Could not parse as JSON: ${e.message}`);
                }
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }

        async function testCalendar() {
            log('Testing calendar...');
            try {
                const url = `${SCRIPT_URL}?function=getCalendarEventsApp&authToken=${AUTH_TOKEN}&startDate=2025-06-01&endDate=2025-06-30`;
                log(`URL: ${url}`);
                
                const response = await fetch(url);
                log(`Response status: ${response.status}`);
                log(`Response ok: ${response.ok}`);
                
                const data = await response.text();
                log(`Response text: ${data}`);
                
                try {
                    const jsonData = JSON.parse(data);
                    log(`Parsed JSON: ${JSON.stringify(jsonData, null, 2)}`);
                } catch (e) {
                    log(`Could not parse as JSON: ${e.message}`);
                }
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }

        async function testStripe() {
            log('Testing Stripe...');
            try {
                const url = `${SCRIPT_URL}?function=triggerStripePayment&authToken=${AUTH_TOKEN}&amount=100.00&description=Test`;
                log(`URL: ${url}`);
                
                const response = await fetch(url);
                log(`Response status: ${response.status}`);
                log(`Response ok: ${response.ok}`);
                
                const data = await response.text();
                log(`Response text: ${data}`);
                
                try {
                    const jsonData = JSON.parse(data);
                    log(`Parsed JSON: ${JSON.stringify(jsonData, null, 2)}`);
                } catch (e) {
                    log(`Could not parse as JSON: ${e.message}`);
                }
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }
    </script>
</body>
</html>
